---
typora-copy-images-to: web.assets
---

# **ТЕМА 2.6 СКРИПТЫ**

Скрипты (или сценарии) представляют собой программы, написанные на специальном языке скриптов: JavaScript, VBScript, Perl и др. Различают клиентские скрипты и скрипты, выполняемые на стороне сервера. Последние использовать нежелательно, т.к. это приводит к более частому обмену данными между сервером и удаленным пользователем. Однако есть случаи, когда применение скриптов, выполняемых на стороне сервера, является необходимым:

Ø для динамического поддержания Web-страницы с переменным со- держанием, учитывающим информацию об удаленном пользователе;

Ø для поддержания взаимодействия Web-страницы с базами данных, хранящимися на сервере;

Ø для организации взаимодействия Web-страницы с какими-либо вне- ними прикладными программами и отображения результатов их выполнения в содержимом страницы.

 

## Для обработки форм пользователя на сервере

Клиентские скрипты сопровождают HTML-документ или встраиваются в его содержимое. Использование скриптов позволяет сделать документы более интерактивными и внешне привлекательными. Скрипты позволяют:

Ø изменять содержимое документа и его представление во время загрузки;

Ø производить обработку таких событий как загрузка, удаление опре- деленной информации HTML-документа, перемещение мыши, на- жатие кнопок на мыши и т.п.;

Ø осуществлять предварительную обработку вводимых в формы дан- ных, например, заполнять определенные поля формы по данным, введенным в другие поля;

Ø управлять фокусом в рамках документа;

Ø осуществлять возможности пользовательского интерфейса на Web- странице.

Скрипты разделяются на два типа:

Ø скрипты, выполняющиеся один раз при загрузке документа;

Ø скрипты, выполняемые всякий раз, когда происходит определенное событие.

Вот далеко не полный список возможностей, реализуемых с помощью клиентских скриптов:

Ø Создание бегущих строк и сообщений в статусной строке браузера.

Ø Выпадающие горизонтальные и вертикальные меню.

Ø Перемещаемые меню.

Ø Создание системных кнопок различного назначения.

Ø Создание анимационного следа вслед за движущимся курсором.

Ø Календарь.

Ø Создание окон с сообщениями.

Ø Звуковое сопровождение ссылок.

Ø Часы.

Ø Создание переливающихся изображений (эффект волн).



Ø Отключение правой или левой кнопки мыши.

Ø Создание уникального меню, возникающего при нажатии на правую или левую кнопки мыши.

Ø Определение браузера посетителя и перенаправление на соответ- ствующую страницу, что позволяет наиболее полно использовать возможности каждого браузера, а не создавать браузеронезависи- мые документы, в которых используются только элементы, поддер- живаемые всеми браузерами.

Включение скрипта в HTML-документ осуществляет элемент SCRIPT, описание которого было приведено в главе "Структура документа в формате HTML". Элемент SCRIPT может быть задан как в заголовке, так и в теле документа.

Браузеры при обработке документа не могут определить язык скрипта самостоятельно и, следовательно, корректно его интерпретировать. При использовании скриптов необходимо указывать язык, на котором они написаны. В HTML возможны два способа задания языка скриптов:

Ø установить определенный язык в качестве используемого по умол- чанию;

Ø указывать язык персонально для каждого скрипта при его задании.

Чтобы задать определенный язык сценариев используемым по умолчанию, надо либо указать его название в заголовке HTML-документа через элемент МЕТА:

<МЕТА http-equiv="Content-Script-Type" content="text/javascript"> либо в поле Content-Script-Type заголовка HTTP:

Content-Script-Type: text/javascript.

Языком скриптов, установленным по умолчанию, считается язык, указанный в последнем объявлении Content-Script-Type элемента МЕТА. Аналогичное поле HTTP-заголовка при этом не учитывается. Если отсутствует объявление языка скриптов в элементах МЕТА, то по умолчанию используется язык, указанный в HTTP-заголовке.

Чтобы указать язык для конкретного скрипта, применяется атрибут Туре элемента SCRIPT. Задание языка в самом элементе SCRIPT имеет приоритет над заданным по умолчанию, но только для одного конкретного скрипта.

Пример HTML-документа со скриптом JavaScript, реализующим бегущую строку текста в строке статуса браузера (рис. 3.90):

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<HTML>

<HEAD>

<TITLE>Документ с бегущей строкой</TITLE>

</HEAD>

<BODY bgcolor=lightgrey onload="timerONE=window.setTimeout('scrollit_r21(100) ' , 500);">

<script type="text/JavaScript"> function scrollit_r21(seed)

{

var ml - "БЕГУЩАЯ СТРОКА 1!"; var m2 = "БЕГУЩАЯ СТРОКА 2!";

var m3 = "ВВЕДИТЕ СВОЙ ТЕКСТ!";

var msg=ml+m2+m3; var out = " ";

var с = 1;

if (seed > 100)



{

seed—;

var cmd="scrollit_r21 (" + seed + ")"; timerTwo=window.setTimeout(cmd, 100);

}

else if (seed <= 100 && seed > 0)

{

for (c=0; с < seed; с++)

{

out+=" ";

}

out+=msg; seed-;

var cmd="scrollit_r21(" + seed + ")"; window.status=out; timerTwo=window.setTimeout(cmd, 100);

}

else if (seed <= 0)

{

if (-seed < msg.length)

{

out+=msg.substring(-seed, msg.length); seed—;

var cmd="scrollit_r21 (" + seed + ")"; window.status=out; timerTwo=window.setTiraeout(cmd, 100);

}

else

{

window.status=" "; timerTwo=window.setTimeout("scrollit_r21(100)", 75);

}

}

}

 

</script>

<Н2>Документ с бегущей строкой текста в строке статуса<Н2> текст документа      <BR>

текст документа <BR> текст документа <BR> текст документа <BR> текст документа <BR> текст документа <BR> текст документа  <BR>

</BODY> </HTML>

 

 

***римечание.\*** *Чтобы использовать этот скрипт, не зная JavaScript, достаточно просто перенести текст его кода в код своего документа, заменив выражения "Бегущая строка 1", "Бегущая строка 2" и т.д. на желаемые. Текст кода этого и некоторых других скриптов представлены на CD, прилагаемом к книге.*



Выполнение скриптов можно привязать к определенным событиям. Эти события представляют собой результат работы пользователя с HTML- документом в окне браузера. Привязка скриптов к событиям осуществляется по схеме Имя_события=Имя_скрипта

В HTML 4.01 различают следующие события, указываемые в качестве атрибутов элементов, для которых они определены:

**Onclick** — событие, происходящее при однократном нажатии кнопки мыши, когда курсор наведен на содержимое элемента, для которого опре- делено это событие.

**Ondblclick** — событие, происходящее при двойном нажатии кнопки мыши, когда курсор наведен на содержимое элемента, для которого определено это событие.

**Onload** — это событие происходит, когда браузер закончил загрузку документа в окно или всех фреймов. Задается у элементов BODY и FRAMESET.

**Onunload** — это событие происходит, когда браузер закончил удаление документа из своего окна или из фрейма. Задается у элементов BODY и FRAMESET.

**Onmousedown** — это событие происходит при нажатии кнопки мыши, когда курсор наведен на содержимое элемента, для которого определено это событие.

**Onmouseup** — это событие происходит при отпускании кнопки мыши, когда курсор наведен на содержимое элемента, для которого определено это событие.

**Onmouseover** — это событие происходит, когда курсор находится над содержимым элемента для которого определено это событие.

**Onmousemove** — это событие происходит при перемещении курсора над содержимым элемента, для которого определено это событие.

**Onmouseout** — это событие происходит при перемещении курсора за пределы содержимого элемента, для которого определено это событие.

**Onfocus** — это событие происходит, когда элемент, для которого определено это событие, получает фокус. Фокус на элемент может быть установлен либо с помощью "мыши", либо с помощью перебора элементов последовательности перебора (клавишей "Tab", например). Событие (атрибут) Onfocus может быть определено у следующих элементов: LABEL, INPUT, SELECT, TEXTAREA и BOTTON.

**Onblur** — это событие происходит при переходе фокуса с элемента, для которого определено это событие.

**Onkeypress** — это событие происходит при нажатии и отпускании любой клавиши на содержимом элемента. Событие Onkeypress определено почти для всех HTML-элементов.

**Onkeydown** — это событие происходит при нажатии любой клавиши на содержимом элемента. Событие Onkeydown определено почти для всех НТМL- элементов.

**Onkeyup** — это событие происходит при отпускании нажатой на содержимом элемента клавиши. Событие Onkeyup определено почти для всех НТМ L-элементов.

**Onsubmit** — это событие происходит при отправке формы. Соответственно, оно может быть определено только для элемента формы FORM.

**Onereset** — это событие происходит при сбросе содержимого формы. Так же, как и событие Onsubmit, определено только для элемента формы FORM.



**Onselect** — это событие происходит при выделении пользователем некоторого текстового фрагмента в текстовом поле. В качестве последнего может выступать содержимое элементов INPUT и TEXTAREA. Именно для них и может быть определено событие Onselect.

**Onchange** — это событие происходит при потере управляющим элементом фокуса, если с момента получения фокуса его содержимое было изменено. Событие Onchange может быть определено для элементов заполнения форм SELECT, INPUT и TEXTAREA.

В вышеприведенном примере с бегущей строкой задействовано событие Onload элемента BODY. Однако скрипты могут и не привязываться к событиям. Ниже приведен пример как раз с таким скриптом, отмечающим действие правой кнопки "мышки" (рис. 3.91).

 

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<HTML>

<HEAD>

<TITLE>Документ с бегущей строкой</TITLE>

<SCRIPT type="text/javascript">

var message="Правая кнопка мыши отключена!"; // Здесь введите свою надпись, которая появится в окне предупреждения

function click(e)

{

if (document.all)

{

if (event.button == 2)

{ // Чтобы отключить левую кнопку поставьте цифру 1 alert(message);

return false;

}

}

if (document.layers)

{

if (e.which == 3)

{

alert(message); return false;

}

}

}

if (document.layers)

{

document.captureEvents(Event.MOUSEDOWN);

}

document.onmousedown=click;

</SCRIPT>

</HEAD>

<BODY bgcolor=white>

<H2 align=center>Документ, у которого отключена правая кнопка мыши</ Н2>

текст документа <BR> текст документа <BR> текст документа <BR> текст документа <BR>



текст документа <BR> текст документа <BR> текст документа <BR>

</BODY>

</HTML>

 

 

 

## Работа с пользователями, не поддерживающими скрипты

 

На всякий случай разработчиком должна быть предусмотрена корректная обработка документа пользователями, не поддерживающими скрипты. Для этого предполагается ипользование элемента NOSCRIPT и метода сокрытия скрипта.

 

## Элемент NOSCRIPT

 

С помощью элемента NOSCRIPT реализуется возможность задания альтернативного содержимого скрипта, если он не может быть выполнен. Содержимое этого элемента отображается в окне браузера в трех случаях:

Ø когда браузер по своей природе не поддерживает скрипты;

Ø когда браузер так настроен, чтобы не поддерживать скрипты;

Ø когда браузер вообще поддерживает скрипты, но не поддерживает данный язык скриптов.

Задание начального и конечного тегов элемента NOSCRIPT является обязательным. Например:

<SCRIPT type="text/porh"> текст скрипта написанного

на языке porh         (вымышленном) который вставляет в страницу переливающуюся картинку

</SCRIPT>

<NOSCRIPT>

<!--вместо переливающейся будет вставлена обычная картинка-->

<IMG src="kartinka.gif"

</NOSCRIPT>

 

## Сокрытие скрипта от пользователя

 

Эта проблема вызвана тем, что браузерами, не поддерживающими скрипты, содержимое элемента SCRIPT (код самого скрипта) может отображаться как обычный текст. Чтобы этого не происходило, применяется метод сокрытия скрипта от пользователя, в рамках которого возможны два пути:

Ø заключить код скрипта (все содержимое элемента SCRIPT) в SGML- комментарии. Такое задание приводит к тому, что браузерами, не поддерживающими скрипты, код скрипта воспринимается как ком- ментарий и не отображается. Например:

<SCRIPT type="тext/javascript"> код скрипта код скрипта // --> </SCRIPT>

Однако в этом случае возникает проблема сокрытия символов SGML-



комментариев (<!— и —>) теперь от самого итерпретатора данного языка скриптов. Этот вопрос решается для каждого языка индивидуально.

Ø Другой путь сокрытия скрипта заключается в использовании вне- шних скриптов, расположенных в отдельных внешних файлах и подключаемых с помощью атрибута src элемента **SCRIPT.** Например:

<SCRIPT type="text/javascript" src="/SCRIPT/flick.js"> </SCRIPT>

 

## Заключение скриптов различных языков в комментарии

 

*Комментирование скриптов на **JavaScript***

В языке скриптов JavaScript допускается использование комбинации символов <!— в начале кода скрипта. При этом интерпретатором игнорируется вся строка, в которой такая комбинация присутствует. Поэтому **сам** код скрипта должен начинаться со следующей строки. Чтобы не воспринимался и закрывающий SGML-комментарий "—>", необходимо указать перед ним символ "//"• Это означает, что вся строка, расположенная после "//" **в** JavaScript воспринимается как комментарий.

 *Пример задания:*

<SCRIPT type="text/javascript"> <!--

код скрипта код скрипта код скрипта //--> </SCRIPT>

 

*Комментирование скриптов на **VBScript***

Ситуация комментирования VBScript-скриптов аналогична коммен- тированию JavaScript-скриптов, за тем лишь исключением, что вместо символа "//" используется символ одинарной кавычки:

<SCRIPT type="text/vbscript"> < !--код скрипта код скрипта -->

</SCRIPT>